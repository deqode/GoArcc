syntax = "proto3";
package alfred.git.v1;

option go_package = "/pb";

import "google/protobuf/timestamp.proto";
import "google/api/annotation.proto";
import "include/graphql.proto";
import "types/enums.proto";

service GitService {
    //listReposistory list all reposistory of user's account
    rpc listReposistory(ListReposistoryRequest) returns (ListReposistoryResponse){
        option (google.api.http) = {
            get: "/v1/vcs-connection/reposistories/{provider}"
        };
        option (graphql.schema) = {
            type: QUERY
            name: "reposistories"
        };
    }

    //GetReposistory get's a reposistory with their branches
    rpc GetReposistory(GetReposistoryRequest) returns (Reposistory){
        option (google.api.http) = {
            get: "/v1/vcs-connection/reposistory/{repo_name}"
        };
        option (graphql.schema) = {
            type: QUERY
            name: "reposistory"
        };
    }
}


message Reposistory{
    string id = 1;
    string node_id = 2;
    string name = 3;
    string full_name = 4;
    string default_branch = 6;
    string master_branch = 7;
    google.protobuf.Timestamp created_at = 8;
    google.protobuf.Timestamp pushed_at = 9;
    google.protobuf.Timestamp updated_at = 10;
    string clone_url = 11;
    string git_url = 12;
    int32 size = 13;
    bool private = 14;
    repeated string branches = 15;
}

message ListReposistoryRequest{
    types.GitProviders provider = 1;
    string user_id = 2;
    string account_id = 3;
}
message ListReposistoryResponse{
    repeated Reposistory reposistories = 1;
}

message GetReposistoryRequest{
    types.GitProviders provider = 1;
    string repo_name = 2;
    string account_id = 3;
}
